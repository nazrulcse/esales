<div class="col-lg-12 order-details">
  <div class="col-lg-4">Last Transaction:<span class="available_price"><%= @transactions.where(status: SubscriberTransaction::TRANSACTION_STATE[:complete]).last.amount if @transactions.where(status: SubscriberTransaction::TRANSACTION_STATE[:complete]).last.present? %></span> </div>
  <div class="col-lg-4 ">Available Money: <span class="available_price"><%= SubscriberTransaction.available_money(current_user.id) %></span></div>
  <div class="col-lg-4">
    <% if SubscriberTransaction.available_money(current_user.id) > 0 %>
        <button type="button" class="btn btn-default"  data-backdrop="false" data-toggle="modal" data-target="#myModal">Withdraw Money</button>
    <% end %>
  </div>
</div>
<% if @transactions.present? %>
<table class="table order-table">
  <thead class="order-title">
  <tr>
    <th> Chanel </th>
    <th>Amount</th>
    <th> Mobile</th>
    <th> Bank</th>
    <th>Address</th>
    <th> Status</th>
  </tr>
  </thead>
  <tbody>
  <% @transactions.each do |tr| %>
      <tr>
        <td><%= tr.chanel %></td>
        <td><%= tr.amount %></td>
        <td><%= tr.mobile %></td>
        <td><%= tr.bank %></td>
        <td><%= tr.address %></td>
        <td class="item"><%= SubscriberTransaction::TRANSACTION_STATE.index(tr.status) %> </td>
      </tr>
  <% end %>
  </tbody>
</table>
<% end %>


<div class="modal fade" id="myModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">New Transaction</h4>
      </div>
      <div class="modal-body clearfix">
        <div class="col-lg-12">
          <%= form_for @transaction do |f| %>
              <div class="form-inputs form-group">
                <div class="form-group float">
                  <div class="form-group">
                    <%= f.label :chanel, 'Chanel' %> <br/>
                    <%= f.select :chanel, options_for_select(SubscriberTransaction::CHANEL.collect { |key, value| [value, value] }), {prompt: 'Select Chanel'}, {class: 'form-control'} %>
                  </div>
                </div>

                <div class="form-group float optional salaries_advance_amount">
                  <div class="form-group">
                    <%= f.label :amount, 'Amount' %> <br/>
                    <%= f.text_field :amount, class: 'form-control' %>
                  </div>
                </div>

                <div class="form-group float optional salaries_advance_amount">
                  <div class="form-group">
                    <%= f.label :mobile, 'Mobile' %> <br/>
                    <%= f.text_field :mobile, class: 'form-control' %>
                  </div>
                </div>

                <div class="form-group float optional salaries_advance_amount">
                  <div class="form-group">
                    <%= f.label :bank, 'Bank Account' %> <br/>
                    <%= f.text_field :bank, class: 'form-control' %>
                  </div>
                </div>

                <div class="form-group float optional salaries_advance_amount">
                  <div class="form-group">
                    <%= f.label :address, 'Address' %> <br/>
                    <%= f.text_area :address, class: 'form-control' %>
                  </div>
                </div>
              </div>

              <div class="form-group clearfix">
                <div class="col-sm-12">
                  <%= f.submit 'Withdraw', class: 'btn btn-info pull-right' %>
                </div>
              </div>
          <%end%>
        </div>
      </div>
      <div class="modal-footer">
      </div>
    </div>

  </div>
</div>